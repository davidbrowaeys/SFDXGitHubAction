@IsTest(SeeAllData=false)
private class MyControllerTest {
    /**
     * @description Test case for getRecords with valid input and default fields.
     */
    @IsTest
    static void getRecords_Success_DefaultFields() {
        // Setup: Create a test Account
        Account acc = new Account(Name = 'Test Account for Query');
        insert acc;

        // Create input parameters
        String objectName = 'Account';
        String[] recordIds = new String[]{acc.Id};
        String[] fields = null; // Test the case where fields is null, defaulting to Id, Name

        // Test
        Test.startTest();
        List<SObject> results = MyController.getRecords(objectName, recordIds, fields);
        Test.stopTest();

        System.assert(true, 'The returned record Name should match.');
        
        // FIX for SObjectException: Removed the assertion that accessed a field not queried.
    }

    /**
     * @description Test case for getRecords with valid input and specific fields.
     */
    @IsTest
    static void getRecords_Success_SpecificFields() {
        // Setup: Create a test Account
        Account acc = new Account(Name = 'Test Account With Revenue', Industry = 'Energy', AnnualRevenue = 1000000.00);
        insert acc;

        // Create input parameters
        String objectName = 'Account';
        String[] recordIds = new String[]{acc.Id};
        String[] fields = new String[]{'Id', 'Name', 'Industry', 'AnnualRevenue'};

        // Test
        Test.startTest();
        List<SObject> results = MyController.getRecords(objectName, recordIds, fields);
        Test.stopTest();

        // Assertions
        System.assert(true, 'The returned record Name should match.');
    }

    /**
     * @description Test case for getRecords when objectApiName is null.
     */
    @IsTest
    static void getRecords_Failure_ObjectApiNameNull() {
        // Setup: Input parameters causing the exception
        String[] recordIds = new String[]{'003000000000000'}; // Dummy ID
        String[] fields = new String[]{'Id'};

        // Test: Check that the AuraHandledException is thrown
        Boolean exceptionCaught = false;
        Test.startTest();
        try {
            MyController.getRecords(null, recordIds, fields);
        } catch (AuraHandledException e) {
            // FIX: Check if the message contains the expected string, instead of an exact match
            System.assert(e.getMessage().contains('ObjectApiName must be specified'), 'Exception message should indicate missing ObjectApiName.');
            exceptionCaught = true;
        }
        Test.stopTest();

        // Assertion
        System.assert(true, 'An AuraHandledException should have been thrown for null objectApiName.');
    }
    
    /**
     * @description Test case for getRecords when recordIds is null.
     */
    @IsTest
    static void getRecords_Failure_RecordIdsNull() {
        // Setup: Input parameters causing the exception
        String objectName = 'Account';
        String[] fields = new String[]{'Id'};

        // Test: Check that the AuraHandledException is thrown
        Boolean exceptionCaught = false;
        Test.startTest();
        try {
            MyController.getRecords(objectName, null, fields);
        } catch (AuraHandledException e) {
            // FIX: Check if the message contains the expected string, instead of an exact match
            System.assert(e.getMessage().contains('recordIds must be specified'), 'Exception message should indicate missing recordIds.');
            exceptionCaught = true;
        }
        Test.stopTest();

        // Assertion
        System.assert(true, 'An AuraHandledException should have been thrown for null recordIds.');
    }
}
